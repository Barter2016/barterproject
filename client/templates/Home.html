<div ng-cloak id="home-view">

    <!-- Loading -->
    <div class="loading grey-background" layout="column" layout-align="center center" ng-show="!data_loaded">
        <md-progress-circular md-mode="indeterminate" class="md-primary" md-diameter="80"></md-progress-circular>
    </div>

    <!-- Content -->
    <div layout="column" ng-show="data_loaded">
        <md-card flex>
            <md-card-title class="border-bottom">
                <md-subheader class="md-primary md-no-sticky">Recherche</md-subheader>
            </md-card-title>
            <md-card-content class="no-padding">
                <div layout="row" class="md-padding">
                    <md-input-container flex>
                        <label>Nom de l'annonce</label>
                        <input type="text" ng-model="productNameToFind">
                    </md-input-container>
                    <md-input-container flex>
                        <label>Categorie</label>
                        <md-select ng-model="selectedCategory">
                            <md-option ng-value="Aucune" ng-selected="true">Aucune</md-option>
                            <md-option ng-repeat="category in categories | orderBy: 'category_name.S'" ng-value="{{category}}">{{category.category_name.S}}</md-option>
                        </md-select>
                    </md-input-container>
                </div>
            </md-card-content>
            <md-card-actions>
                <div layout="row" layout-align="start center">
                    <md-button class="md-raised md-primary" ng-click="searchProduct()">
                        <md-icon class="material-icons">search</md-icon>
                        Rechercher
                    </md-button>
                    <span flex></span>
                    <md-button class="md-primary md-icon-button" ng-click="goBackInHistory()">
                        <md-icon class="material-icons">keyboard_arrow_left</md-icon>
                        <md-tooltip md-direction="top" md-autohide="true">
                            Reculer dans votre historique de recherches
                        </md-tooltip>
                    </md-button>
                    <md-button class="md-primary md-icon-button" ng-click="goFowardInHistory()">
                        <md-icon class="material-icons">keyboard_arrow_right</md-icon>
                        <md-tooltip md-direction="top" md-autohide="true">
                            Avancer dans votre historique de recherches
                        </md-tooltip>
                    </md-button>
                </div>
            </md-card-actions>
        </md-card>
        <md-card flex>
            <md-card-title class="border-bottom">
                <md-divider></md-divider>
                <md-subheader class="md-primary md-no-sticky">Les annonces</md-subheader>
                <span flex></span>
                <md-button class="md-icon-button md-primary" ng-click="refreshProducts()">
                    <md-icon class="material-icons">refresh</md-icon>
                    <md-tooltip md-direction="top">Actualiser</md-tooltip>
                </md-button>
                <md-divider></md-divider>
            </md-card-title>
            <md-card-content class="no-padding text-center">
                <md-list layout="column" class="offers-list">
                    <md-list-item class="md-2-line" ng-repeat="product in productsToDisplay | orderBy: 'product_date':true " ng-click="viewProduct(product.product_id.S)">
                        <div class="list-image" flex="15" layout="column" layout-align="center center" ng-show="product.image_urls['SS'] !== undefined">
                            <img ng-src="{{ product.image_urls['SS'][0] }}" />
                        </div>
                        <div class="list-image" layout="column" layout-align="center center" ng-show="product.image_urls['SS'] == undefined">
                                        <img ng-src="https://s3-us-west-2.amazonaws.com/barter-project-bucket/photo_non_disponible.jpg"/>
                                    </div>
                        <div class="md-list-item-text" flex="65" layout="column">
                            <h3>{{ product.product_name.S }}</h3>
                            <p>{{ product.product_description.S }}</p>
                        </div>
                        <div class="md-list-item-text" flex="20" layout="column" layout-align="center center">
                            <p>{{ product.product_date | date: "dd/MM/yyyy 'Ã ' h:mma" }}</p>
                        </div>
                        <md-divider></md-divider>
                    </md-list-item>
                </md-list>
                <md-button class="md-primary" ng-click="loadMoreProduct()">Afficher plus</md-button>
            </md-card-content>
        </md-card>
    </div>
</div>